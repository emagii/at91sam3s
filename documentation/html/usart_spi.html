<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAM3S Software Package: USART SPI Mode Example</title>
<link href="common/style.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
    <div id="body">
        <div id="title">SAM3S Software Package 2.1</div>
        <div id="banner"></div>

<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="page_examples.html">Examples for SAM3S-EK</a>      </li>
      <li><a class="el" href="page_examples_basic.html">Basic Examples</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>USART SPI Mode Example </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="Purpose"></a>
Purpose</h2>
<p>This example demonstrates the SPI mode provided by the USART peripherals on SAM3S.</p>
<h2><a class="anchor" id="Requirements"></a>
Requirements</h2>
<p>This example can be used on sam3s evaluation kit and usart1 and spi pins should be connected as following matching table:</p>
<ul>
<li><b> USART1 -- SPI </b><ul>
<li>SCK1(PA23) -- <a class="el" href="spi__dataflash_2main_8c.html#ab0b85f88106c448804e16bb055c600cd">SPCK(PA14)</a></li>
<li>TXD1(PA22) -- MOSI(PA13</li>
<li>RXD1(PA21) -- MISO(PA12)</li>
<li>RTS(PA24) -- NPCS0(PA11) (for USART1 as SPI master)</li>
</ul>
</li>
</ul>
<ul>
<li><b> USART1 -- SPI </b><ul>
<li>SCK1(PA23) -- <a class="el" href="spi__dataflash_2main_8c.html#ab0b85f88106c448804e16bb055c600cd">SPCK(PA14)</a></li>
<li>RXD1(PA21) -- MOSI(PA13)</li>
<li>TXD1(PA22) -- MISO(PA12)</li>
<li>CTS(PA25) -- NPCS0(PA11) (for USART1 as SPI slave)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="Description"></a>
Description</h2>
<p>This example demonstrates how to use USART in SPI mode. The USART is configured as SPI master or slave. Meanwhile, the SPI peripheral in the microcontroller is configured respectively, making it communicate with the USART peripheral. The example leaves UART to let user to switch the command between READ and WRITE from the view of master.</p>
<p>The application first initializes UART as the interface to interact with users. By default, it initializes USART as SPI master and the SPI peripheral as SPI slave.</p>
<p>The application waits for input from UART:</p>
<ul>
<li>If 'w' is received, the master initiate a transmission by sending a block of data. The slave receives the data and dumps it to UART.</li>
<li>If 'r' is received, the master wait for data from slave and dump it to UART until the reception is finished.</li>
<li>If 's' is received, the master and slave are exchanged between USART1 and SPI. To assure the transferring succeeds, connect pins as the table above.</li>
</ul>
<h2><a class="anchor" id="Usage"></a>
Usage</h2>
<ol type="1">
<li>Build the program and download it inside the evaluation board. Please refer to the <a href="http://www.atmel.com/dyn/resources/prod_documents/doc6224.pdf">SAM-BA User Guide</a>, the <a href="http://www.atmel.com/dyn/resources/prod_documents/doc6310.pdf">GNU-Based Software Development</a> application note or to the <a href="ftp://ftp.iar.se/WWWfiles/arm/Guides/EWARM_UserGuide.ENU.pdf">IAR EWARM User Guide</a>, depending on your chosen solution.</li>
<li>Connect a serial cable to the UART port on the evaluation kit.</li>
<li>On the computer, open and configure a terminal application (e.g. HyperTerminal on Microsoft Windows) with these settings:<ul>
<li>115200 bauds</li>
<li>8 data bits</li>
<li>No parity</li>
<li>1 stop bit</li>
<li>No flow control</li>
</ul>
</li>
<li>Start the application. The following traces shall appear on the terminal: <div class="fragment"><pre class="fragment">     -- USART <a class="code" href="group___s_a_m3_s__base.html#gaadd93900fc87105fa3ef514675d4133b" title="(SPI ) Base Address">SPI</a> Mode Example xxx --
     -- xxxxxx-xx
     -- Compiled: xxx xx xxxx xx:xx:xx --
</pre></div></li>
</ol>
<h2><a class="anchor" id="References"></a>
References</h2>
<ul>
<li><a class="el" href="usart__spi_2main_8c.html">usart_spi/main.c</a></li>
<li><a class="el" href="pio_8h.html">pio.h</a></li>
<li><a class="el" href="usart_8h.html">usart.h</a> </li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
