<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAM3S Software Package: USB Device Framework Usage</title>
<link href="common/style.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
    <div id="body">
        <div id="title">SAM3S Software Package 2.1</div>
        <div id="banner"></div>

<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="usb_library.html">USB Library</a>      </li>
      <li><a class="el" href="usbd_framework.html">AT91 USB device framework</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>USB Device Framework Usage </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="usbd_file_arch"></a>
File Architecture</h2>
<p>The USB framework is made up of the following files: at91lib\boards: device register definition, board-related code and device startup code in assembly language<br/>
 at91lib\utility: debug methods and definitions<br/>
 at91lib\peripherals\dbgu: DBGU port usage for debug<br/>
 at91lib\peripherals\pio: PIO interface usage for Vbus ...<br/>
 at91lib\peripherals\aic: Interrupt configurationi functions<br/>
 at91lib\usb\common\core: structures and methods of standard descriptors and requests<br/>
 at91lib\usb\device\core: UDP controller driver methods and USBD API definitions<br/>
 usb-device-core-project: basic enumeration program, with main.c and Makefile to build the project<br/>
</p>
<h2><a class="anchor" id="usbd_header"></a>
Headers</h2>
<p>When programming your own application, most if not all the headers described in the file architecture of the framework must be included. However, since each header has its own dependencies, they must be included in a particular order.</p>
<p>Here is the standard inclusion order: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;usb/common/core/USBGenericDescriptor.h&gt;</span>
<span class="preprocessor">#include &lt;usb/common/core/USBDeviceDescriptor.h&gt;</span>
<span class="preprocessor">#include &lt;usb/common/core/USBConfigurationDescriptor.h&gt;</span>
<span class="preprocessor">#include &lt;usb/common/core/USBInterfaceDescriptor.h&gt;</span>
<span class="preprocessor">#include &lt;usb/common/core/USBGenericRequest.h&gt;</span>
<span class="preprocessor">#include &lt;usb/device/core/USBD.h&gt;</span>
<span class="preprocessor">#include &lt;usb/device/core/USBDDriver.h&gt;</span>
<span class="preprocessor">#include &lt;usb/device/core/USBDDriverDescriptors.h&gt;</span>
<span class="preprocessor">#include &lt;usb/device/core/USBDCallbacks.h&gt;</span>
</pre></div><p> If a custom class driver has been added, then its header must probably be linked last.</p>
<h2><a class="anchor" id="usbd_build"></a>
Building the Framework</h2>
<p>A Makefile is provided to make it easier to compile the framework. The <em>make</em> program and arm-elf-gcc is necessary to use it.</p>
<p>Several options are available to build the framework in different ways:</p>
<ul>
<li>CHIP<ul>
<li>Target chip for which to build the program.</li>
<li>Possible values: at91sam7s64, at91sam7s128, at91sam7s256, at91sam7s512, at91sam7s321, at91sam7se32, at91sam7se256, at91sam7se512, at91sam7x128, at91sam7x256, at91sam7s512, at91sam7xc128, at91sam7xc256, at91sam7xc512, at91sam9260, at91sam9261, at91sam9263</li>
<li>Default: at91sam7s256</li>
</ul>
</li>
<li>BOARD<ul>
<li>Board used with the chip.</li>
<li>Possible values: at91sam7s-ek, at91sam7se-ek, at91sam7x-ek, at91sam7xc-ek, at91sam7a3-ek, at91sam9260-ek, at91sam9261-ek, at91sam9263-ek</li>
<li>Default: at91sam7s-ek </li>
</ul>
</li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
